# ==========================================
# TRAVIAN T4.6 - DIRENV CONFIGURATION
# ==========================================
# Automatically loads environment variables
# Usage: cd to project root, run `direnv allow`
# ==========================================

# Load environment files (production base + local overrides)
LOADED_FILES=""

# Load production environment as base
if [ -f .env.production ]; then
    dotenv .env.production
    LOADED_FILES=".env.production"
elif [ -f .env ]; then
    # Fallback to generic .env if no production file
    dotenv .env
    LOADED_FILES=".env"
fi

# Load local overrides (takes precedence over production)
if [ -f .env.local ]; then
    dotenv .env.local
    if [ -n "$LOADED_FILES" ]; then
        LOADED_FILES="$LOADED_FILES + .env.local (overrides)"
    else
        LOADED_FILES=".env.local"
    fi
fi

# Display loaded environment
if [ -n "$LOADED_FILES" ]; then
    echo "‚úÖ Environment loaded: $LOADED_FILES"
else
    echo "‚ö†Ô∏è  No environment file found (.env.production, .env.local, or .env)"
fi

# Verify critical variables
if [ -z "$DATABASE_URL" ]; then
    echo "‚ö†Ô∏è  WARNING: DATABASE_URL not set"
fi

if [ -z "$MYSQL_ROOT_PASSWORD" ]; then
    echo "‚ö†Ô∏è  WARNING: MYSQL_ROOT_PASSWORD not set"
fi

# Add helpful commands
alias dc='docker compose'
alias dcup='docker compose up -d'
alias dcdown='docker compose down'
alias dclogs='docker compose logs -f'
alias dcps='docker compose ps'

echo "üì¶ Docker Compose aliases loaded: dc, dcup, dcdown, dclogs, dcps"
